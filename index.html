<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinder - íƒë°° ë°°ì†¡ ì¡°íšŒ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- ë©”ì¸ í™”ë©´ -->
        <div id="mainScreen" class="screen">
            <header class="main-header">
                <h1 class="logo">ğŸ“¦ Pinder</h1>
                <p class="tagline">í©ì–´ì ¸ ìˆëŠ” ë‚´ íƒë°° í•œ ë²ˆì— í™•ì¸í•˜ì„¸ìš”</p>
            </header>

            <div class="input-card">
                <input 
                    type="tel" 
                    id="phoneInput" 
                    class="phone-input" 
                    placeholder="010-1234-5678"
                    maxlength="13"
                >
                <button class="btn-primary" onclick="searchDeliveries()">
                    ì¡°íšŒí•˜ê¸°
                </button>
            </div>
        </div>

        <!-- ë°°ì†¡ í˜„í™© í™”ë©´ -->
        <div id="deliveryScreen" class="screen" style="display: none;">
            <header class="delivery-header">
                <button class="btn-back" onclick="goBack()">
                    â† ëŒì•„ê°€ê¸°
                </button>
                <h2 class="delivery-title">ë°°ì†¡ í˜„í™©</h2>
                <div class="delivery-count">
                    <span id="deliveryCount">0</span>ê±´
                </div>
            </header>

            <div class="delivery-list" id="deliveryList">
                <!-- ë°°ì†¡ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <div class="empty-state" id="emptyState">
                <div class="empty-icon">ğŸ“­</div>
                <p class="empty-text">ë°°ì†¡ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                <p class="empty-subtext">ì£¼ë¬¸ ì‹œ ì…ë ¥í•œ ì „í™”ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”</p>
            </div>
        </div>

        <!-- ë¡œë”© -->
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-spinner"></div>
            <p class="loading-text">ë°°ì†¡ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ì¤‘...</p>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let deliveries = [];

        // ì „í™”ë²ˆí˜¸ í¬ë§·íŒ…
        function formatPhone(value) {
            const numbers = value.replace(/[^\d]/g, '');
            if (numbers.length <= 3) return numbers;
            if (numbers.length <= 7) return numbers.slice(0, 3) + '-' + numbers.slice(3);
            return numbers.slice(0, 3) + '-' + numbers.slice(3, 7) + '-' + numbers.slice(7, 11);
        }

        // ì „í™”ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ìë™ í¬ë§·íŒ…
        const phoneInput = document.getElementById('phoneInput');
        if (phoneInput) {
            phoneInput.addEventListener('input', (e) => {
                e.target.value = formatPhone(e.target.value);
            });

            phoneInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchDeliveries();
                }
            });
        }

        // ë°°ì†¡ ì¡°íšŒ
        async function searchDeliveries() {
            const phone = phoneInput.value.trim();
            
            if (!phone) {
                alert('ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                phoneInput.focus();
                return;
            }

            if (phone.replace(/[^\d]/g, '').length < 10) {
                alert('ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                phoneInput.focus();
                return;
            }

            // ë¡œë”© í‘œì‹œ
            showLoading(true);

            try {
                // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ìƒì„±
                deliveries = generateMockDeliveries();
                
                // ë°°ì†¡ í˜„í™© í™”ë©´ìœ¼ë¡œ ì „í™˜
                showDeliveryScreen();
                
            } catch (error) {
                console.error('ë°°ì†¡ ì¡°íšŒ ì˜¤ë¥˜:', error);
                alert('ë°°ì†¡ ì •ë³´ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                showLoading(false);
            }
        }

        // ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ìƒì„±
        function generateMockDeliveries() {
            const products = [
                'ë¬´ì„  ì´ì–´í° í”„ë¡œ',
                'ë¸”ë£¨íˆ¬ìŠ¤ í‚¤ë³´ë“œ',
                'ìŠ¤í‚¨ì¼€ì–´ ì„¸íŠ¸',
                'ë¦½ìŠ¤í‹± 3ì¢… ì„¸íŠ¸',
                'ë…¸íŠ¸ë¶ íŒŒìš°ì¹˜',
                'ìŠ¤ë§ˆíŠ¸ì›Œì¹˜ ë°´ë“œ',
                'í…€ë¸”ëŸ¬',
                'ìš´ë™í™”'
            ];

            const platforms = ['naver', 'coupang', 'oliveyoung'];
            const statuses = ['ë°œì†¡ì¤€ë¹„', 'ë°°ì†¡ì‹œì‘', 'ë°°ì†¡ì¤‘', 'ë„ì°©'];

            const count = Math.floor(Math.random() * 4) + 3; // 3~6ê°œ
            const result = [];

            for (let i = 0; i < count; i++) {
                const now = new Date();
                const randomHours = Math.floor(Math.random() * 72); // 0~72ì‹œê°„ ì „
                const updateDate = new Date(now - randomHours * 3600000);

                result.push({
                    id: Date.now() + i,
                    productName: products[Math.floor(Math.random() * products.length)],
                    platform: platforms[Math.floor(Math.random() * platforms.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    updatedAt: updateDate
                });
            }

            return result;
        }

        // ë°°ì†¡ í˜„í™© í™”ë©´ í‘œì‹œ
        function showDeliveryScreen() {
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('deliveryScreen').style.display = 'block';
            
            renderDeliveries();
        }

        // ë©”ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        function goBack() {
            document.getElementById('deliveryScreen').style.display = 'none';
            document.getElementById('mainScreen').style.display = 'block';
            
            // ì…ë ¥ ì´ˆê¸°í™”
            phoneInput.value = '';
            deliveries = [];
        }

        // ë°°ì†¡ ëª©ë¡ ë Œë”ë§
        function renderDeliveries() {
            const listContainer = document.getElementById('deliveryList');
            const emptyState = document.getElementById('emptyState');
            const countElement = document.getElementById('deliveryCount');

            if (deliveries.length === 0) {
                listContainer.style.display = 'none';
                emptyState.classList.add('show');
                countElement.textContent = '0';
                return;
            }

            emptyState.classList.remove('show');
            listContainer.style.display = 'flex';
            countElement.textContent = deliveries.length;

            // ìµœì‹ ìˆœ ì •ë ¬
            const sortedDeliveries = [...deliveries].sort((a, b) => 
                new Date(b.updatedAt) - new Date(a.updatedAt)
            );

            listContainer.innerHTML = sortedDeliveries.map(delivery => {
                const platformInfo = getPlatformInfo(delivery.platform);
                const statusClass = getStatusClass(delivery.status);
                
                return `
                    <div class="delivery-item">
                        <div class="delivery-info">
                            <div class="product-name">${delivery.productName}</div>
                            <div class="delivery-meta">
                                <span class="platform-tag platform-${delivery.platform}">
                                    ${platformInfo}
                                </span>
                            </div>
                        </div>
                        <div class="delivery-status-info">
                            <span class="status-badge ${statusClass}">
                                ${delivery.status}
                            </span>
                            <span class="delivery-date">
                                ${formatDateTime(delivery.updatedAt)}
                            </span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ì‡¼í•‘ëª° ì •ë³´
        function getPlatformInfo(platform) {
            const platforms = {
                naver: 'ë„¤ì´ë²„',
                coupang: 'ì¿ íŒ¡',
                oliveyoung: 'ì˜¬ì˜'
            };
            return platforms[platform] || platform;
        }

        // ìƒíƒœ í´ë˜ìŠ¤
        function getStatusClass(status) {
            const statusMap = {
                'ë°œì†¡ì¤€ë¹„': 'status-preparing',
                'ë°°ì†¡ì‹œì‘': 'status-shipping',
                'ë°°ì†¡ì¤‘': 'status-shipping',
                'ë„ì°©': 'status-arrival'
            };
            return statusMap[status] || 'status-preparing';
        }

        // ë‚ ì§œ í¬ë§·íŒ…
        function formatDateTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            const diffHours = Math.floor(diff / (1000 * 60 * 60));
            
            // 24ì‹œê°„ ì´ë‚´ë©´ "Xì‹œê°„ ì „"
            if (diffHours < 24) {
                if (diffHours < 1) {
                    const diffMinutes = Math.floor(diff / (1000 * 60));
                    return `${diffMinutes}ë¶„ ì „`;
                }
                return `${diffHours}ì‹œê°„ ì „`;
            }
            
            // ê·¸ ì™¸ì—ëŠ” ë‚ ì§œ í‘œì‹œ
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            return `${month}.${day} ${hours}:${minutes}`;
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(show) {
            const overlay = document.getElementById('loadingOverlay');
            if (show) {
                overlay.classList.add('show');
            } else {
                overlay.classList.remove('show');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì „í™”ë²ˆí˜¸ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
        window.addEventListener('load', () => {
            if (phoneInput) {
                phoneInput.focus();
            }
        });
    </script>
</body>
</html>
